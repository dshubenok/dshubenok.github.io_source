# Командная строка

Программирование — сложный процесс и он не включает в себя только написание кода. Написанный код нужно как-то запускать, где-то хранить. Первое, с чем ты сталкиваешься, когда начинаешь программировать, и то, к чему нужно привыкать сразу — это командная строка. Командная строка — это интерфейс взаимодействия с операционной системой и другими программами. Обычно он выглядит как черное окошечко с белыми буквами:

![](/img/bash_empty.png)

Тебе хорошо знаком другой интерфейс взаимодействия — графический. В данный момент он у тебя перед глазами. Этот способ взаимодействия идеально подходит для рядовых пользователей — тут есть привычные окошки, которые можно перемещать по экрану или сворачивать, файлы и папки в виде иконок, всё это делает выполнение пользовательских задач интуитивно простым. 

Командный интерфейс взаимодействия работает иначе. В командном интерфейсе ты печатаешь команду, нажимаешь Enter, система выполняет эту команду, пишет на экран результат выполнения и ждёт следующей команды.  Этот называется REPL (**R**ead **E**val **P**rint **L**oop, англ. "Цикл Прочитать, Выполнить, Распечатать"). 

[Тык](https://asciinema.org/a/3y4XQ3RR8GD9u1Cj4W0QGPUdX)

Сначала может показаться, что взаимодействовать с системой таким способом ужасно неудобно, но это только на первый взгляд. На самом деле всё наоборот. Основные преимущества командного интерфейса перед графическим:

- Скорость работы возрастает на порядок.
- Набор команд можно записывать в файлы, то есть писать скрипты. Это позволяет решать сложные задачи, которые в графическом интерфейсе не получится решить в принципе. А также автоматизировать какие-то действия.
- Ты лучше понимаешь все происходящие в системе процессы и можешь их контролировать, потому что работаешь с ней напрямую, а не через "прослойку" в виде графической оболочки. Это открывает практически неограниченные возможности в работе, которые просто недоступны в графическом интерфейсе.
- Возможность подключаться к компьютеру, который расположен где-то очень далеко и выполнять на нём команды. То есть работать с удалённым сервером. На удалённых серверах не бывает графического интерфейса и взаимодействовать с другими компьютерами можно только посредством команд, и делать это нужно будет часто.

Командный интерфейс состоит из командной оболочки и терминала, терминал запускает командную оболочку в графической среде.

**Командная оболочка** (shell) — это программа, передающая ваши команды на выполнение системе, тот самый REPL, про который было написано выше. Самая популярная командная оболочка — bash, она используется по умолчанию в таких операционных системах, как Linux и MacOS. Существует множество других командных оболочек (например, в операционной системе Windows используется своя), но именно bash является стандартом и абсолютно доминирует над всеми остальными. 

Для запуска командной оболочки внутри графического интерфейса потребуется **терминал** — это то самое окошко, внутри которого будет запущен Баш. Терминалов тоже бывает много и они отличаются всякими дополнительными возможностями — можно изменять шрифт, создавать вкладки и прочее. 

![](/img/bash_workflow.png)

Итак, терминал — это программа, которая запускает командную оболочку (тот самый шелл)  в графическом интерфейсе твоей системы. Если у системы нет графического интерфейса, то и в терминале нужды нет. В терминале ты взаимодействуешь с Башем. 

Наверное, тебе уже не терпится выполнить свои первые команды? Окей, давай приступим к практике.

## Запуск Баша в терминале

Если у тебя Мак или на твоем компьютере установлена операционная система Линукс, то просто запусти программу Терминал (Terminal), она так и называется. Перед тобой появится Баш.

Если у тебя Windows, то поможет [https://gitforwindows.org](https://gitforwindows.org/) (это bash-эмулятор для винды). Но в это случае приготовься страдать. Мы рекомендуем тебе в будущем перейти на Linux полностью или поставить Linux в качестве второй операционной системы. Windows не предназначен для программирования (только если ты не пишешь программы конкретно для Windows). 

Если у тебя Windows 10 и ты знаешь толк в извращениях, то можешь интегрировать Linux Ubuntu в свою винду из Microsoft Store. Держи инструкцию: [https://docs.microsoft.com/ru-ru/windows/wsl/install-win10](https://docs.microsoft.com/ru-ru/windows/wsl/install-win10) 

В любом случае, после выполнения вышеперечисленных действий перед твоими глазами должен быть либо полноценный Баш, либо его эмулятор. Напечатай команду `whoami`и нажми Enter. На экране появится твое имя пользователя. Чтобы завершить работу напечатай команду `exit` или просто закрой терминал.

Теперь можно переходить к следующей теме. Если у тебя не получилось выполнить команду `whoami`, то вернись назад и попробуй понять, что ты сделал не так. Мы в тебя верим, до встречи в следующем уроке!

## Первые команды
Вспомни, как открывать и закрывать терминал. 

Сейчас ты начнешь выполнять первые команды. Очень важно выполнять все команды самостоятельно, я не просто читать текст, только так можно научиться. 

Символ $ разделяет служебную информацию слева (имя пользователя, текущая директория) и ввод твоих команд справа.

### Взаимодействие с файловой системой (Навигация).

После запуска графической оболочки ты попадаешь на так называемый Рабочий стол, это точка входа по умолчанию. В командной оболочке ты тоже всегда где-то находишься. Точкой входа для новой сессии является домашняя директория (home directory), и она соответствует текущему имени пользователя, а то место, где ты находишься сейчас — рабочей директорией (working directory). Узнать рабочую директорию (где ты сейчас находишься) можно командой `pwd` (print working directory, так называются большинство команд — по первым буквам).

Всё, что идёт после символа решетки (#) игнорируется башем, мы будем использовать это для комментариев. 

## Перемещение по директориям

![](/img/bash_root.png)

![https://s3-us-west-2.amazonaws.com/secure.notion-static.com/234af6ee-22a1-42ae-a823-9c165a40ae1b/2020-06-07_23.44.25.jpg](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/234af6ee-22a1-42ae-a823-9c165a40ae1b/2020-06-07_23.44.25.jpg)

/ — корневая директория, от неё идут все остальные.

Пути — абсолютный и относительный. 

Абсолютный — идёт от корня и является постоянным. 

Относительный — идёт от той директории, в который ты находишься. Этот путь не постоянный, а зависит от текущий директории. 

Где ты находишься? Ты всегда где-то находишься, чтобы это узнать, есть команда `pwd`:

```bash
pwd 
# print working directory — напечатать текущую директорию
```

Чтобы перейти в другую директорию, используй комнду `cd`:

```bash
cd <путь до директории>
# change directory — сменить директорию
```

Существует короткая запись некоторых наиболее часть используемых директорий:

`.` ссылка на текущую директорию

`..` ссылка на родительскую директорию (ту, которая находится на уровень выше)

`~` (тильда) — домашняя директория. У каждого пользователя есть домашняя директория

Она находится в `/home/<имя пользователя>`(на Линуксе) или `/Users/<имя пользователя>` (на Маке). Тильда ссылается на эту директорию. Чтобы вернуться в домашнюю директорию, просто набери `cd ~`

Для просмотра содержимого директории используй команду `ls`:

```bash
ls
# показать содержимое директории
```

С помощью команды `man` ты можешь прочесть о том, что делает каждая команда, передав ей имя команды в качестве аргумента:

```bash
man ls
# получить справку по команде ls
```

### Ключи

У команд бывают необязательные ключи (опции), которые можно активировать через символ дефиса (иногда у ключа есть полная запись, которая передается через двойной дефис). Например:

`ls` посмотреть, что содержится в текущей директории
`ls -a` (`—all`) ключ `-a` или `—all` показать **всё** (ключ назван от англ. all, "всё") содержимое, даже скрытые файлы (скрытые файлы начинаются с символа точки). Скрытые файлы обычно не нужно трогать, поэтому они скрытые
`ls -l` подробные данные про каждый файл
Ключи можно комбинировать, для этого их надо ставить вместе: `ls -lah` (попробуй понять, что делает ключ `-h`)
`ls` можно передавать директорию и смотреть что в ней: `ls ../somedirectory` покажет, что в директории `somedirectory`, которая находится на уровень выше, для этого не нужно переходить в неё

Узнай свою текущую директорию `pwd`. Переместись на директорию выше `cd ..`, проверь текущее местонахождение `pwd` и вернись обратно `cd <имя пользователя>`.

Перемещайся на уровень выше, пока не дойдешь до корневой директории, посмотри что там интересного с помощью команды `ls`. Если заблудишься, всегда можно вернуться домой с помощью `cd ~` (вернуться в домашнюю директорию). 

## Манипуляции с директориями и файлами

Окей, перемещаться по директориям научились, давай посмотрим, как выполнять над директориями какие-либо действия. Большинство команд работает и для файлов.

### Создать, удалить, скопировать, переместить

`mkdir` cоздать директорию, можно передавать несколько параметров, например, команда `mkdir one two three`создаст сразу три дирекории

Команда `touch <имя файла>` создает файл. Если применить к существующему файлу, то обновится его время последнего изменения

`rm` удалить **пустую** директорию или файл

`cp file1 myfolder/file2` сделать копию файла `file1`и поместить в директорию `myfolder` под именем `file2`

`mv` переместить, работает так же, как и предыдущая команда, только вместо копии выполняет перенос файла. Если "перенести" файл в текущую директорию с новым именем, то файл просто переименуется: `mv old_filename new_filename`

### Вывести на экран

`cat` —  весь файл, `head` — верхняя часть, `tail` — нижняя часть

`cat file.txt` — вывести содержимое файла `file.txt`

`head -n 3` — вывести верхний кусочек файла (первые три строчки)

`head -c 10` — вывести первые 10 символов файла

`tail -n 3` — вывести конец файла (последние 3 строчки)

`tail -c 10` — вывести последние 10 символов

`echo <text>` — просто выводит на экран текст, который ты передаешь в качестве аргумента

### Комбинирование команд

Команды можно комбинировать и записывать в одну строку. 

`;` — независимо от результата предыдущей команды выполнить следующую

`&&` — то же самое, то с условием успешного выполнения предыдущей команды

Примеры: 

`mkdir myfolder && cd myfolder` команда создаст директорию myfolder и перейдёт в неё. Если директория уже существует, то ничего не будет выполнено

`mkdir myfolder; cd myfolder` команда создаст директорию myfolder и перейдёт в неё. Если директория уже существует, то просто перейдет в неё

### Перенаправление ввода-вывода

Символами стрелочек можно перенаправлять результат выполнения команды в файл:

```bash
echo Hi > greetings
# перенаправит Hi в файл greetings

date > current_datetime
# перенаправит текущую дату и время в файл current_datetime
```

`>` перенаправление в файл, перезаписывает файл, если файла нет, то он будет создан

`>>` перенаправление в файл, добавляет в конец, если файла нет, то он будет создан

### Консольные редакторы текста

Среди консольных редакторов кода самые популярные: vi(m) и nano, для знакомства мы рассмотрим nano, потому что он проще.

`nano` — запустить консольный редактор nano:

![](/img/bash_nano.png)

Нано очень дружелюбный: внизу есть список команд с горячими клавишами (значок `^` означает `Ctrl`). Попрактикуйся немного с ними, это понадобится для выполнения практического задания.

`nano file` — открыть в редактое файл с именем `file`, если такой файл отсутствует, то он будет создан с пустым содержимым

Сохранить: Ctrl+O

Выйти: Ctrl+X, Yes. Если файл был изменен, то будет предложено его сохранить.

### Поиск по шаблону

`grep` — это поиск по шаблону

`grep 42 file` (найти упоминания числа "42" в файле `file`)

`grep 42 file -с` (вывести количество упоминаний "42" в файле `file`)

`grep -i привет file` (ignore case) будет искать привет в файле `file` без учета регистра ("привет", "Привет", "ПРИВЕТ", "пРиВеТ" и так далее)

Перенаправление вывода (пайпы). 

### Пайпы

Пайпом называется прямая черта `|`, с помощью которой можно строить команды по принципу конвейера — то есть, результат выполнения прошлой команды будет передаваться на вход следующей команде:

```bash
cat file | grep '#'
# передали содержимое файла file в grep, 
# который поискал в этом содержимом символ решетки

cat file | grep '#' > str_with_hash
# передали содержимое файла file в grep, 
# который поискал в этом содержимом символ решетки
# и записали найденные строки в файл str_with_hash
```

### Полезности.

**Автозаполнение**. Начинай вводить имя файла и нажми Tab.

**История команд**. Стрелочками на клавиатуре можно возвращать уже выполненные команды, чтобы снова их не набирать. Попробуй понажимать стрелку вверх.